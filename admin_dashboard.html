<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - DLib K12</title>
    <link rel="stylesheet" href="css/admin_dash.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="wrapper">
        <nav class="sidebar">
            <div class="brand"><i class="fas fa-book-reader"></i> <span>DLib K12</span></div>
            <ul class="menu">
                <li class="active"><a href="admin_dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                
                <li><a href="admin_resources.html"><i class="fas fa-database"></i> Quản lý tài nguyên số</a></li>
                
                <li><a href="admin_books.html"><i class="fas fa-book"></i> Quản lý Sách</a></li>
                <li><a href="admin_loans.html"><i class="fas fa-clipboard-list"></i> Quản lý Mượn Trả</a></li>
                <li><a href="admin_users.html"><i class="fas fa-users"></i> Quản lý Tài khoản</a></li>
                <li class="logout"><a href="#" onclick="DB.logout()"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a></li>
            </ul>
        </nav>

        <main class="main-content">
            <div class="top-bar">
                <h2>Dashboard Tổng Quan</h2>
                <div class="user-profile">Admin <img src="https://via.placeholder.com/40"></div>
            </div>

            <div class="dashboard-grid top-row">
                <div class="filter-card">
                    <label>Thời gian thống kê</label>
                    <select id="time-filter" onchange="updateDateRange()">
                        <option value="this_week">Tuần này</option>
                        <option value="last_week">Tuần trước</option>
                        <option value="this_month" selected>Tháng này</option>
                        <option value="last_month">Tháng trước</option>
                        <option value="this_year">Năm nay</option>
                    </select>
                    <div class="date-range" id="date-display">Đang tải...</div>
                </div>
                <div class="stat-card">
                    <div class="stat-text"><h2 id="total-users" style="color: #722ed1;">0</h2><p>Thành viên</p></div>
                    <div class="mini-chart" style="background: conic-gradient(#722ed1 70%, #eee 0);"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-text"><h2 style="color: #1890ff;">114</h2><p>Lượt Tương tác</p></div>
                    <div class="mini-chart" style="background: conic-gradient(#1890ff 40%, #52c41a 40% 80%, #eee 0);"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-text"><h2 id="total-resources" style="color: #f5222d;">0</h2><p>Tổng Tài nguyên</p></div>
                    <div class="mini-chart" style="background: conic-gradient(#f5222d 60%, #faad14 60% 85%, #1890ff 85% 100%);"></div>
                </div>
            </div>

            <div class="dashboard-grid middle-row">
                <div class="panel chart-panel">
                    <h3>Thống kê truy cập</h3>
                    <div class="bar-chart" style="justify-content: center; gap: 60px;">
                        <div class="bar-col" style="width: 80px;">
                            <span id="val-sv" style="font-weight: bold; color: #722ed1; margin-bottom: 5px;">0</span>
                            <div class="bar" id="bar-sv" style="height: 0%; background-color: #722ed1; width: 100%;"></div>
                            <span style="margin-top: 10px; font-weight: 600;">Sinh viên</span>
                        </div>
                        <div class="bar-col" style="width: 80px;">
                            <span id="val-gv" style="font-weight: bold; color: #faad14; margin-bottom: 5px;">0</span>
                            <div class="bar" id="bar-gv" style="height: 0%; background-color: #faad14; width: 100%;"></div>
                            <span style="margin-top: 10px; font-weight: 600;">Giảng viên</span>
                        </div>
                    </div>
                </div>

                <div class="panel list-panel">
                    <h3>Top tài nguyên xem nhiều nhất</h3>
                    <ul class="item-list" id="top-resources-list"></ul>
                </div>

                <div class="panel chart-panel">
                    <h3>Thống kê số lượng tài liệu</h3>
                    <div class="bar-chart" id="interaction-chart" style="justify-content: space-around; gap: 10px;">
                        <div class="bar-col" style="width: 20%;">
                            <span id="v-sach" style="font-weight:bold; font-size:12px; color:#722ed1; margin-bottom:5px">0</span>
                            <div class="bar purple" id="b-sach" style="height: 0%"></div>
                            <span>Sách</span>
                        </div>
                        <div class="bar-col" style="width: 20%;">
                            <span id="v-ebook" style="font-weight:bold; font-size:12px; color:#722ed1; margin-bottom:5px">0</span>
                            <div class="bar purple" id="b-ebook" style="height: 0%"></div>
                            <span>Ebook</span>
                        </div>
                        <div class="bar-col" style="width: 20%;">
                            <span id="v-pdf" style="font-weight:bold; font-size:12px; color:#722ed1; margin-bottom:5px">0</span>
                            <div class="bar purple" id="b-pdf" style="height: 0%"></div>
                            <span>PDF</span>
                        </div>
                        <div class="bar-col" style="width: 20%;">
                            <span id="v-video" style="font-weight:bold; font-size:12px; color:#722ed1; margin-bottom:5px">0</span>
                            <div class="bar purple" id="b-video" style="height: 0%"></div>
                            <span>Video</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid bottom-row" style="grid-template-columns: 1fr 1fr;">
                <div class="panel list-panel">
                    <h3>Tài nguyên số mới</h3>
                    <ul class="item-list" id="new-resources-list"></ul>
                </div>

                <div class="panel list-panel">
                    <h3>Sách giấy mới</h3>
                    <ul class="item-list" id="new-books-list"></ul>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/data.js"></script>
    <script src="js/admin_dash.js"></script>
</body>
</html>